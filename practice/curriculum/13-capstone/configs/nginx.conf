# =============================================================================
# Section 12 â€” Nginx Reverse Proxy Configuration
# Guide: docs/curriculum/13-capstone-project.md
#
# Exercise: Configure Nginx as a reverse proxy for the FastAPI app.
#
# TODO:
# 1. Define upstream block pointing to app:8000
# 2. Add rate limiting zone (limit_req_zone)
# 3. Configure server block on port 80 with:
#    - proxy_pass to upstream
#    - Security headers (X-Content-Type-Options, X-Frame-Options, etc.)
#    - Gzip compression
#    - /nginx-health endpoint returning 200
#    - Rate limiting on /predict
# =============================================================================

# events {
#     worker_connections 1024;
# }
#
# http {
#     # --- Upstream ---
#     upstream app_backend {
#         server app:8000;
#     }
#
#     # --- Rate Limiting ---
#     # TODO: limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
#
#     # --- Gzip ---
#     # TODO: Enable gzip for application/json
#
#     server {
#         listen 80;
#         server_name _;
#
#         # --- Security Headers ---
#         # TODO: add_header X-Content-Type-Options "nosniff" always;
#         # TODO: add_header X-Frame-Options "DENY" always;
#         # TODO: add_header X-XSS-Protection "1; mode=block" always;
#
#         # --- Nginx Health ---
#         location /nginx-health {
#             access_log off;
#             return 200 "nginx ok\n";
#             add_header Content-Type text/plain;
#         }
#
#         # --- Rate-limited predict endpoint ---
#         # location /predict {
#         #     limit_req zone=api burst=20 nodelay;
#         #     proxy_pass http://app_backend;
#         #     proxy_set_header Host $host;
#         #     proxy_set_header X-Real-IP $remote_addr;
#         # }
#
#         # --- Default proxy ---
#         location / {
#             proxy_pass http://app_backend;
#             proxy_set_header Host $host;
#             proxy_set_header X-Real-IP $remote_addr;
#             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#             proxy_set_header X-Forwarded-Proto $scheme;
#         }
#     }
# }
