# Capstone Docker Compose — Full Stack
# Guide: docs/curriculum/13-capstone-project.md
# Integrates: App, Nginx, Prometheus, Redis, Grafana

# TODO: Complete the full-stack compose file

# version: "3.9"
# services:
#
#   # --- Nginx Reverse Proxy (Section 12) ---
#   nginx:
#     image: nginx:alpine
#     ports:
#       - "80:80"            # External entry point
#     volumes:
#       - ./configs/nginx.conf:/etc/nginx/nginx.conf:ro
#     depends_on:
#       app:
#         condition: service_healthy
#     restart: unless-stopped
#
#   # --- Application ---
#   app:
#     build: .
#     expose:
#       - "8000"             # Internal only — Nginx routes to this
#     env_file:
#       - .env               # Load secrets from .env (Section 10)
#     environment:
#       - LOG_LEVEL=info
#       - DATABASE_URL=sqlite:///data/predictions.db
#       - REDIS_URL=redis://redis:6379/0
#     volumes:
#       - app-data:/app/data # Persist SQLite DB (Section 09)
#     healthcheck:
#       test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
#       interval: 30s
#       timeout: 5s
#       retries: 3
#     restart: unless-stopped
#
#   # --- Redis Cache (Section 09 optional) ---
#   redis:
#     image: redis:7-alpine
#     expose:
#       - "6379"
#     volumes:
#       - redis-data:/data
#     healthcheck:
#       test: ["CMD", "redis-cli", "ping"]
#       interval: 10s
#       timeout: 3s
#       retries: 3
#     restart: unless-stopped
#
#   # --- Prometheus (Section 07) ---
#   prometheus:
#     image: prom/prometheus:latest
#     ports:
#       - "9090:9090"
#     volumes:
#       - ./prometheus.yml:/etc/prometheus/prometheus.yml
#     restart: unless-stopped
#
#   # --- Grafana (Section 07) ---
#   grafana:
#     image: grafana/grafana:latest
#     ports:
#       - "3000:3000"
#     restart: unless-stopped
#
# volumes:
#   app-data:
#   redis-data:
