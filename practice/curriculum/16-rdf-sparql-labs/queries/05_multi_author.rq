PREFIX dct:    <http://purl.org/dc/terms/>
PREFIX schema: <http://schema.org/>

# Q5: Books with multiple authors
# Uses HAVING to find books with more than one author
SELECT ?title (GROUP_CONCAT(?authorName; separator=", ") AS ?authors) (COUNT(?authorNode) AS ?authorCount)
WHERE {
    ?book a schema:Book ;
          dct:title ?title ;
          schema:author ?authorNode .
    ?authorNode schema:name ?authorName .
}
GROUP BY ?title
HAVING (COUNT(?authorNode) > 1)
ORDER BY ?title
